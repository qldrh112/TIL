# 20240529
## 최후의 1분
### 오전
#### 특강
##### AI 프롬프트 엔지니어링
1회 휴식  

##### 비밀번호는 이제 그만
보안 직무를 수행하는 직원: 보안 솔루션 개발자, 보안 알고리즘 개발자(동형학), 보안 전문 분석가(화이트 해커), 보안 관제사  

요즘은 피싱 사이트와 일반 사이트의 경계가 허물어지고 있다.  

패스키: 앱이나 사이트 이용 시 고유 비밀번호를 입력하지 않고, 얼굴 인식이나 지문, 화면 잠금, 개인 식별 번호(PIN)을 이용해 로그인할 수 있는 기술  
종단 간 암호화 기술을 이용해 유출되는 개인 정보가 없도록 설계한다.  

해킹 사례의 81%는 취약하거나 도난당한 비밀번호로 인해 발생함  
그리고 점차 악성 피싱 이메일이 증가하고, 점차 정교해지고 있다.  

MFE를 쓰는 것이 좋다.  

기억력 기반 패스워드(일반적으로 우리가 사용하는), 패스워드 매니저, SMS/OTP, passkeys  

패스키는 추정, 재사용, 기기, 피싱, 서버 유출 등에서 안전한 편이다.  

패스키란 무엇인가?  
APPLE, Google, MicroSoft에서 fido 표준 지원 확대를 가속화 하고 있다.  

UAF: 비밀번호가 필요하지 않는 온라인 환경을 지원한다.  
생체 인증, PIN 등 다양한 방법을 통해 보안 및 편의성을 제공한다.  

FIDO2가 U2F를 병합  
지문을 등록하면 fido는 authenticator에서 생성한다.  

passkey fido2는 중간에 변경이 불가능하다.  
디바이스와 동기화하여 암호를 쓸 수 있게 할 수 있다.  
그런데 키가 암호화된 채 돌아다닌다고? 라는 반문

fido에서 이것을 해명하기 위한 노력 중  


삼성 페이의 월렛과 동일한 과정으로 진행한다.  

트렌드는 관련해서 유명한 사이트가 있다.  
자격증은 프로젝트 + 그에 대한 설명 이후 3번째다.  

QR code를 통한 개인정보 보호 서비스  
택배 상품의 메타데이터 확인, secret project & security document sheadding operation, 배달, 예약 시스템  


project에 security 적용시 tip
- 단말에 생체 인증을 사용하면 보안이 최고인가?
- RSA, ECC가 무엇인지 그리고 어떻게 활용하는지 알면 보안 전문가  
- base64와 base64 url의 차이가 무엇인지 아는 것은 기본이다.
- json외에 다른 포맷에 대해서도 관심을 가지자.  
- 인터넷에 많은 tool과 자료가 있으니 테스트 데이터를 잘 활용하자.  


### 오후
#### 특강
##### 소프트웨어 문제 풀이 방법으로 현업 문제 개선 사례

왜가 중요하다.  
동라쿠처럼 해야 한다.  
취업이 끝이 아니다.  
지식을 잘 아는 것도 중요하지만, 빠케모노가 되려면 남들이 하지 못 하는 것을 해야 한다.  
그것을 위해서는 푸는 능력이 중요하다.  


random.randrange(K) < N  
이것은 N/K를 나타낸다고 하는군요

인덱스를 랜덤으로 구해서 그 인덱스를 pop하면 시간 복잡도가 O(KN)로 폭등한다.  

그럼 pop을 안 하면 되지 않노?  
그러면 선택 여부를 알아보면 사전을 만들어 버리다.  
hash = O(1)  
orderedDict O(logN)  

동전의 확룰이 다를 때 어떻게 승자를 정할 거냐?  
10번 던지는 건 비용이 크다.  

그러면 2번만 던지고, 앞뒤는 내가 승, 뒤앞은 상대방 승 이런 식으로 진행한다.  

`random.shuffle`: 리스트 안의 요소를 무작위로 섞는다.  

게임은 확률이 100/10000이다. 1/100으로 해놓지 않는다.  
하나의 DB를 pk값을 기준으로 N개 단위로 짤라먹는 방법도 있다.  

512GB 중 51GB를 뽑아야 한다.  
근데 shuffle을 얹을 수 없다.  

솔루션1: 나눠서 셔플 -> 확률 100%가 보장이 되는가? Nope 
유니폼  

N/K의 확률은 모든 것이 나올 수 있다는 100%의 보장이 안 된다.  
5개 중 1개 선택 -> 4개 중 1개 선택 -> 3개 중 1개 선택  

라인마다 prior queue로 관리하는 방법도 있다.  
10억 개의 문장에 0~1의 값을 부여하고 선택하는 것은 uniform이다.  

우선 순위 큐를 사용한 알고리즘 문제는 많이 사용된다.  

문자열이 같으면 해시값이 같다.  
그렇다고 해시값이 같다고 문자열이 같다고 볼 순 없다.  

10억개를 나눠서 1억개로 나눠서 한다.  
그런데 1억 사이에 중복이 있을 수 있다.  

모든 문장에 해시번호를 적용해서 분류를 하고, 안에서 중복 처리를 하고, 

##### 서버 관리
보안은 모의해킹, 정책, 개발, 암호 알고리즘이 있다.  

웹 해킹을 잘 알아두어야 한다.  
웹 프로젝트를 진행하면서 사실 보안에 많은 신경을 쓰지 못 했다.  
기본 기능만 구현했었다.  

비밀번호 암호화를 하기 위해 우리는 무엇을 하는가?  
hash  

역공학: 어셈블리어를 알아야 함  
저수준언어, 고수준언어  
저급 언어를 뜯어보고 분석해서 고급 언어로 만드는 것  

system(), eval() 이렇게 시스템에 직접적으로 명령을 주는 함수, 로직 상 shell의 권한 상승을 하는 것을 -> system hacking 라고 한다.  

network hacking: 스니핑, 중간자 공격, Dos, 

Cryptography: des, seed, aes, rsa 등의 기법이 존재한다.  
근데 des, sha-1는 이미 뚫렸다.  
그래서 3-DES로 암호화, 복호화, 암호화 과정을 거치는 것이 존재했다.  

digital forensic: 흔적 찾기  

오늘 배운 내용을 실서버에 활용하면 곤란하다.  

###### Cryptography
비밀번호를 base64로 암호화를 했다.  
안 되지 않나? 복호화 딸깍이면 되는 거 아님?  

비밀번호는 인코딩 디코딩 하는 게 아니고, 암호화는 가능하되, 복호화가 가능해서는 안 된다.  

윈도우랑 리눅스랑 개행을 처리하는 방식이 다르다.  

프로토콜  
Method URI Vession \n     
Header \n\n  
Data  

여기 데이터에서 개행이 한 번 들어가면 시스템은 혼란스러워한다.  
인코딩할 때 우리는 base64를 많이 쓴다.  
cp949, utf-8이 뭐냐  

base64는 =이 1개나 2개 정도 뒤에 붙는다.  
그래서 =가 뒤에 나왔다면 base64로 디코딩을 해보는 것이다.  

해시는 정해진 길이로 반환하는 것  
`len(1gb -> sha2) == len(1byte -> sha)`  

길이가 같다보니 값이 같은 게 생길 수 있음(해시 충돌 )  
비둘기집 원리 -> 정해진 공간이 꽉찼을 때, 어느 한 데이터는 동일한 공간에 채워지는 현상  

대칭 키: 암호화와 복호화에 동일한 KEY를 사용하는 방식  
XOR 연산을 많이 사용한다.  
그러면 왜 xor을 왜 사용하냐?  

A xor B = C  
B xor C = A  
A xor C = B  

다시 쉽게 복구할 수 있으니 사용한다.  

해킹 대회 참여해보면 말도 안 되게 큰 파일을 하나 주고 뭐가 많음  
이 중에서 우리가 단순히 하나하나 xor 연산으로 암호화를 해놨다고 하면  
복호화하려면 다시 xor 연산을 하면 되지요  

그러면 비대칭 키는 어떻게 암호화하고 복호화를 하는가?  
모듈러 연산을 이용한다.  
공개키: 모두가 알 수 있는 키  
이걸 가지고 암호화를 한다.  
앨리스란 작자가 밥의 공개키로 암호화하면 밥만 볼 수 있다.  
왜? 밥이 개인키를 가지고 있기 때문에  

그럼 만약에 앨리스의 비밀키로 암호화하면 모두가 그 내용을 볼 수 있다.  
근데 그거는 무슨 의미? 내가 암호화했다는 것을 증명  
전자서명에 사용한다.  

암호학, 수학, 알고리즘에서는 항상 소수가 등장한다.  
N이 소수임을 우리는 판단할 수 있냐?  
물론  

1. 서로 다른 두 소수를 선택한다.  
2. N = pq를 계산한다.  
3. N의 오일러 파이(피) 함수를 계산  (p-1)(q-1)
4. 1 < e < 3120인 e 가운데 오일러파이와 서로소인 임의의 숫자를 선택한다.  
5. e(mod(오일러함수))에 대한 곱의 역원 ed(mod오일러함수()) = 1인 숫자 d를 계산한다.  

3233만 보고 두 개의 소수곱을 구할 수 있겠냐?  
가능 1~n까지 넣어보면 대충 나올 것이다.  

근데 암호를 이렇게 뚫리기 쉽게 만들면 안 될 것이다.  
소수는 그럼 말도 안 되게 큰 소수로 해야 한다.  
최소 300자 이상의 소수를 사용해야 한다.  
특정하기 쉬운 소수를 사용해선 안 되기 때문이다.  

중국인의 나머지 정리: 공부해보시길  

###### Digital Forensic
랜섬웨어: 돈을 지불해야만 파일의 암호화를 복호화해주는 악성 소프트웨어  

랜섬웨어는 대칭키를 쓸 수도 있고, 비대칭키를 쓸 수도 있습니다.  

volatile Memory: 저장된 정보를 유지하기 위해 전기가 필요한 메모리(RAM)    
non-volatile Memory: 정보를 유지하는데 전기가 필요없는 메모리(HDD, Rom(read-only-memory))  

암호화된 데이터를 복구하려면 어떻게 해야 할까?  
1. 복구 프로그램을 찾기 위해 찾아본다. -> x
2. 컴퓨터를 종료하고 복구 방법을 찾은 후 해결한다. -> x  
3. 돈을 주고 기다린다?  -> 삐  

1번이 안 되는 이유: 어떤 프로그램을 실행하면 램에 올라가고 랜섬웨어의 키가 어디로 세어버릴 가능성이 있다.    

2번이 안 되는 이유: volatile memory가 날라감  

그러니까 그대로 두고 신고한다.  

하드디스크의 방식이 연속인지, chain인지, 인덱스인지에 따라서 달라진다.  
그리고 이것을 해결하는 데 필요한 유용한 program  
volatility: 메모리 덤프, FTK(무료), EnCase 등이 있다.  
  
해시를 통해 원본과 복사본을 확인하여 동일함을 증명할 수 있다.  

###### Reverse Engineering
실행하면 .class, .sys, .dll을 만들어낸다.  
파일은 시그니처와 확장자가 있다.  
시그니처에는 헤더와 MZ가 있다.  

reverse Engineering: 어떤 프로그램이나 코드를 분석하여 핵심 기능을 파악하는 것  
calling convention: 함수 호출 규약으로 함수를 호출할 때, 파라미터를 전달하는 방식에 대한 약속  
cdecl, stdcall, fastcall 등이 있다.  

main함수에서 printf를 호출했다면 main이 caller고 printf가 callee가 될 것이다.  

cdecl: 주로 c언어에서 사용하는 방식으로 caller에서 스택을 정리하는 방식  

재귀함수에서 기저조건을 넣어주지 않으면 stackoverflow가 발생한다.  

Jmp: 그냥 점프  
cmp: 비교  
je: 같으면 점프  

디버거: GDB, OllyDBG(x32), x64DBG(ASM), jd-gui(바이트 코드: 언어 -> java, c#), IDA(c코드 복구), Ghidra(ASM->C, 무료, 디컴파일러)  

###### System Hacking(Pwnable)  
system hacking: 프로그램의 로직 상 허점을 이용하여 시스템의 상위 권한을 탈취하는 방법  

이 파트는 메모리 구조를 정확하게 알고 있어야 한다.  
buffer overflow: 10칸 공간에 11개를 넣었을 때 buffer의 크기를 벗어나기에 에러가 발생함  
buffer, canary, stack frame pointer, return address  
canary는 랜덤으롣 들어가는데 버퍼를 넘은 값이 들어오면 중단시킨다.  

버퍼를 출력한다고 했을 때, 어디까지 될까?  
null일 때까지   

Return to Library(Libo)(RTL)  
stack 내부에 실행할 수 있는 코드를 삽입하여 실행시킬 수 있는 취약점을 방지하고자 설정한 NX bit을 우회하는 기법  

Return Oriented Programming (ROP): 메모리에 올라간 데이터에서 어셈블리 코드의 조각을 모아 하나의 명령어를 구성하여 취약점을 만들어내는 방법  

shell code: 작은 크기의 코드로 쉘을 실행시키기 위한 코드 조각이며 보통 어셈블리어로 작성한다.  
거대한 함수의 집합 = 커널  

###### Network Hacking
Dos: 특정 서버의 서비스를 제공하지 못하게 하는 공격 기법  
서버에 수많은 요청을 하면 가용된 자원이 부족해서 멈추게 된다.  

ping of death: dos의 공격방식, MTU에 가까운 데이터를 엄청 크게 보내서 서버가 그것을 처리하다가 다운시키는 방법  
그래서 서버에서는 일반적으로 ICMP 프로토콜을 허용하지 않는다.  

land attack: 대상 서버에서 출발지와 목적지 ip를 자기 자신으로 설정하게 하는 기법  
DDOS: 분산(Distribted) 서버에게 공격해라. 하면 iot기기가 서버에 명령을 쏜다.  
DRDos: 공격자의 ip를 노출시키지 않게 하며 취약한 시스템의 ip를 이용하여 공격하는 기법이다.  

F/W, IPS, Anti-DDos를 통해 네트워크에서 발생할 수 있는 취약점과 공격기법을 차단하는 도구  
Signature: snort와 suricata를 통해 룰을 만들어냄  

###### Web Hacking
네트워크를 이용하여 클라이언트 및 서버의 통신을 탈취 및 방해하는 기법  
cross site scripting / cross sitre request forgery  

document.cookie => 세션 값이 들어있다.  
B가 A의 세션을 통해 서비스를 무단으로 이용할 수 있다.  
허나 요즘은 쿠키가 httpOnly를 달아둬서 http 통신에만 사용할 수 있게 했다.  

SQL: 구조화된 질의 언어  
SQL injection: 입력이 가능한 모든 부분에 sql을 작성하여 서버의 데이터를 탈취하는 방법  

해킹대회: CTF, 데프콘  
